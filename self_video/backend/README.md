# ğŸ¤– Agent Skills - å…¬ä¼—å·æ–‡ç« å‘å¸ƒç³»ç»Ÿ

åŸºäº **Python FastAPI** åç«¯ + **SSE æµå¼è¾“å‡º** çš„ Agent Skills ç³»ç»Ÿï¼Œå®ç°æ™ºèƒ½åŒ–å…¬ä¼—å·æ–‡ç« ç”Ÿæˆå·¥ä½œæµã€‚

## ğŸ¯ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Frontend (index.html)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ConfigMgr   â”‚  â”‚ ApiClient    â”‚  â”‚ UIController    â”‚     â”‚
â”‚  â”‚ (æœ¬åœ°å­˜å‚¨)   â”‚  â”‚ (HTTP/SSE)   â”‚  â”‚ (DOMæ¸²æŸ“)       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     SSE Stream                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Python FastAPI Backend                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ /api/skills â”‚  â”‚/api/workflow â”‚  â”‚ /api/config     â”‚     â”‚
â”‚  â”‚   GET       â”‚  â”‚   POST (SSE) â”‚  â”‚   POST          â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  WorkflowEngine                              â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚     â”‚              Context (ä¸Šä¸‹æ–‡)            â”‚             â”‚
â”‚     â”‚  skill1 â†’ skill2 â†’ skill3 â†’ skill4 â†’ skill5          â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     LLMClient                                â”‚
â”‚            async stream_chat_completion()                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           External LLM API (OpenAI/æ™ºè°±/DeepSeek...)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config.py              # é…ç½®ç®¡ç† (ç¯å¢ƒå˜é‡)
â”‚   â”œâ”€â”€ llm_client.py          # å¤§æ¨¡å‹å®¢æˆ·ç«¯ (å¼‚æ­¥æµå¼)
â”‚   â”œâ”€â”€ main.py                # FastAPI ä¸»å…¥å£
â”‚   â”œâ”€â”€ skills/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base.py            # Skill æŠ½è±¡åŸºç±»
â”‚   â”‚   â””â”€â”€ definitions.py     # 5ä¸ªSkillå®ç° + æ³¨å†Œä¸­å¿ƒ
â”‚   â””â”€â”€ workflow/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ engine.py          # å·¥ä½œæµå¼•æ“ (äº‹ä»¶é©±åŠ¨)
â”œâ”€â”€ index.html                 # å‰ç«¯é¡µé¢ (è°ƒç”¨åç«¯API)
â”œâ”€â”€ requirements.txt           # Python ä¾èµ–
â”œâ”€â”€ .env.example              # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â””â”€â”€ README.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ API Key
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼
python -m backend.main

# æˆ–ä½¿ç”¨ uvicorn
uvicorn backend.main:app --reload --host 0.0.0.0 --port 8000
```

### 4. è®¿é—®æœåŠ¡

- APIæ–‡æ¡£: http://localhost:8000/docs
- å‰ç«¯é¡µé¢: ç”¨æµè§ˆå™¨æ‰“å¼€ index.html
- æˆ–ä½¿ç”¨ Live Server ç­‰å·¥å…·å¯åŠ¨å‰ç«¯

## ğŸ”„ å‰åç«¯äº¤äº’æµç¨‹

```
1. å‰ç«¯å¯åŠ¨ â†’ GET /api/health æ£€æŸ¥åç«¯çŠ¶æ€
2. åç«¯åœ¨çº¿ â†’ GET /api/skills åŠ è½½æ‰€æœ‰Skills
3. ç”¨æˆ·è¾“å…¥ä¸»é¢˜ â†’ POST /api/workflow/run
4. åç«¯è¿”å› SSE æµ:
   â”œâ”€â”€ event: workflow:start
   â”œâ”€â”€ event: skill:start (skill_id: topic_analysis)
   â”œâ”€â”€ event: skill:stream (chunk: "...")  â† å®æ—¶æµå¼
   â”œâ”€â”€ event: skill:stream (chunk: "...")
   â”œâ”€â”€ event: skill:complete
   â”œâ”€â”€ ... (é‡å¤5ä¸ªskill)
   â””â”€â”€ event: workflow:complete
5. å‰ç«¯å®æ—¶æ¸²æŸ“æ¯ä¸ª chunk
```

## ğŸ“¡ API æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/skills` | è·å–æ‰€æœ‰ Skills åˆ—è¡¨ |
| GET | `/api/skills/{id}` | è·å–å•ä¸ª Skill ä¿¡æ¯ |
| POST | `/api/workflow/run` | è¿è¡Œå®Œæ•´å·¥ä½œæµ (SSEæµå¼) |
| POST | `/api/skill/execute` | æ‰§è¡Œå•ä¸ª Skill (SSEæµå¼) |
| POST | `/api/config/validate` | éªŒè¯ API é…ç½® |
| GET | `/api/health` | å¥åº·æ£€æŸ¥ |

### è¿è¡Œå·¥ä½œæµç¤ºä¾‹

```bash
curl -X POST http://localhost:8000/api/workflow/run \
  -H "Content-Type: application/json" \
  -d '{
    "topic": "2024å¹´AIå‘å±•è¶‹åŠ¿",
    "config": {
      "provider": "openai",
      "base_url": "https://api.openai.com/v1",
      "api_key": "sk-xxx",
      "model": "gpt-4o-mini"
    }
  }'
```

## ğŸ”§ 6ä¸ªæ ¸å¿ƒ Skills

| Skill | ID | åŠŸèƒ½ |
|-------|-----|------|
| ğŸ¯ é€‰é¢˜åˆ†æ | `topic_analysis` | åˆ†æä¸»é¢˜çƒ­åº¦ã€å—ä¼—ã€ç«å“ |
| ğŸ“š ææ–™æ”¶é›† | `material_collection` | æ”¶é›†æ•°æ®ã€æ¡ˆä¾‹ã€è§‚ç‚¹ |
| âœï¸ æ™ºèƒ½å†™ç¨¿ | `article_writing` | ç”Ÿæˆ1500-2000å­—æ–‡ç«  |
| ğŸ” å†…å®¹å®¡æ ¸ | `content_review` | è´¨é‡è¯„åˆ†ã€SEOä¼˜åŒ–å»ºè®® |
| ğŸ“ ä¿®æ”¹ä¼˜åŒ– | `article_revision` | æ ¹æ®å®¡æ ¸æ„è§ä¿®æ”¹æ–‡ç«  |
| ğŸš€ å‘å¸ƒè§„åˆ’ | `publish_plan` | å‘å¸ƒæ—¶é—´ã€æ¨å¹¿æ–¹æ¡ˆ |

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Frontend (index.html)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â†“ SSE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  FastAPI (main.py)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ /api/skills â”‚  â”‚/api/workflowâ”‚  â”‚ /api/config â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 WorkflowEngine                           â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚     â”‚                 Context                  â”‚         â”‚
â”‚     â”‚  topic_analysis â†’ material_collection   â”‚         â”‚
â”‚     â”‚        â†’ article_writing â†’ content_review        â”‚
â”‚     â”‚      â†’ article_revision â†’ publish_plan   â”‚         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    LLMClient                             â”‚
â”‚         stream_chat_completion (å¼‚æ­¥ç”Ÿæˆå™¨)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              External LLM API (OpenAI/æ™ºè°±/...)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”Œ æ”¯æŒçš„æ¨¡å‹æä¾›å•†

- **OpenAI**: GPT-4, GPT-4o, GPT-4o-mini
- **æ™ºè°±AI**: GLM-4, GLM-4-Flash
- **DeepSeek**: DeepSeek-Chat
- **Moonshot**: Moonshot-v1
- **é€šä¹‰åƒé—®**: Qwen-Turbo, Qwen-Plus
- **è‡ªå®šä¹‰**: ä»»ä½•å…¼å®¹ OpenAI API æ ¼å¼çš„æœåŠ¡

## ğŸ“ æ‰©å±• Skill

åˆ›å»ºæ–°çš„ Skill åªéœ€ç»§æ‰¿ `BaseSkill`:

```python
from backend.skills.base import BaseSkill, SkillInput

class MyCustomSkill(BaseSkill):
    def __init__(self):
        super().__init__()
        self.id = "my_custom_skill"
        self.name = "è‡ªå®šä¹‰æŠ€èƒ½"
        self.description = "è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æŠ€èƒ½"
        self.icon = "âš¡"
    
    def get_system_prompt(self) -> str:
        return "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šåŠ©æ‰‹..."
    
    def get_user_prompt(self, input_data: SkillInput) -> str:
        return f"å¤„ç†: {input_data.topic}"

# æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒ
from backend.skills.definitions import skill_registry
skill_registry.register(MyCustomSkill())
```

## ğŸ“„ License

MIT License
